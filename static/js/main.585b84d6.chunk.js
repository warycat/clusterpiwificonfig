(this.webpackJsonpclusterpiwificonfig=this.webpackJsonpclusterpiwificonfig||[]).push([[0],{68:function(e,t,n){e.exports=n(84)},73:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var a,r,i,c,o,s,l,u,p,d,h,f,b=n(0),m=n.n(b),v=n(10),w=n.n(v),g=(n(73),n(15)),y=n.n(g),O=n(19),j=n(17),E=n(30),S=n(31),k=n(16),x=(n(46),n(6)),C=n(58),P=(a=function(){function e(t){Object(E.a)(this,e),Object(j.a)(this,"connected",r,this),Object(j.a)(this,"log",i,this),this.device=t}return Object(S.a)(e,[{key:"init",value:function(){var e=Object(O.a)(y.a.mark((function e(){var t=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.device.gatt.connect();case 3:return this.server=e.sent,this.connected=this.device.gatt.connected,e.next=7,this.server.getPrimaryService("6e400001-b5a3-f393-e0a9-e50e24dcca9e");case 7:return this.service=e.sent,e.next=10,this.service.getCharacteristic("6e400003-b5a3-f393-e0a9-e50e24dcca9e");case 10:return this.tx=e.sent,this.tx.startNotifications(),this.tx.addEventListener("characteristicvaluechanged",(function(e){return t.onTx(e.target.value)})),e.next=15,this.service.getCharacteristic("6e400002-b5a3-f393-e0a9-e50e24dcca9e");case 15:return this.rx=e.sent,e.abrupt("return",this);case 19:e.prev=19,e.t0=e.catch(0),console.log("error"),console.log(e.t0);case 23:case"end":return e.stop()}}),e,this,[[0,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"onTx",value:function(e){for(var t=[],n=0;n<e.byteLength;n++)t[n]=e.getUint8(n);var a=String.fromCharCode.apply(null,t);this.log+=a,console.log(a)}},{key:"send",value:function(e){try{var t=new TextEncoder;this.rx.writeValue(t.encode(e))}catch(n){console.log(n)}}}]),e}(),r=Object(k.a)(a.prototype,"connected",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i=Object(k.a)(a.prototype,"log",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a),$=(c=function(){function e(){Object(E.a)(this,e),Object(j.a)(this,"dict",o,this)}return Object(S.a)(e,[{key:"scan",value:function(){var e=Object(O.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Requesting Bluetooth Device..."),e.next=4,navigator.bluetooth.requestDevice({filters:[{name:"rpi-gatt-server"}],optionalServices:["6e400001-b5a3-f393-e0a9-e50e24dcca9e"]});case 4:t=e.sent,n=new P(t),this.dict.set(n.device.id,n),n.init(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=Object(O.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(C.a)(this.dict.values());try{for(t.s();!(n=t.n()).done;)n.value.send(z.script)}catch(a){t.e(a)}finally{t.f()}case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(O.a)(y.a.mark((function e(){var t,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in this.dict)(n=this.dict[t]).gatt.connected&&(n.gatt.disconnect(),console.log("Disconnected"));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"n",get:function(){return Object.keys(this.dict).length}}]),e}(),o=Object(k.a)(c.prototype,"dict",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),Object(k.a)(c.prototype,"n",[x.computed],Object.getOwnPropertyDescriptor(c.prototype,"n"),c.prototype),c),F=new(s=function(){function e(){var t=this;Object(E.a)(this,e),Object(j.a)(this,"open",l,this),Object(j.a)(this,"curSsid",u,this),Object(j.a)(this,"curPassword",p,this),Object(j.a)(this,"newSsid",d,this),Object(j.a)(this,"newPassword",h,this),Object(j.a)(this,"cluster",f,this),this.handleClickOpen=function(){t.newSsid=t.curSsid,t.newPassword=t.curPassword,t.open=!0},this.handleClose=function(e){t.open=!1},this.handleConfirm=function(e){t.curSsid=t.newSsid,t.curPassword=t.newPassword,t.open=!1},this.handleScan=function(){var e=Object(O.a)(y.a.mark((function e(n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.cluster.scan();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.handleSend=function(){var e=Object(O.a)(y.a.mark((function e(n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.cluster.send();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}return Object(S.a)(e,[{key:"script",get:function(){return'\nS="'.concat(this.curSsid,'"\nP="').concat(this.curPassword,'"\nF="/etc/wpa_supplicant/wpa_supplicant.conf"\nTS=$(wpa_passphrase $S $P | sed -n "/ssid=\\"[^\\"]*\\"/p")\nFS=$(cat $F | sed -n "/ssid=\\"[^\\"]*\\"/p")\nTP=$(wpa_passphrase $S $P | sed "/#psk=\\"[^\\"]*\\"/d" | sed -n "/psk/p")\nFP=$(cat $F | sed "/#psk=\\"[^\\"]*\\"/d" | sed -n "/psk/p")\nsed -i "s/$FS/$TS/" $F\nsed -i "s/$FP/$TP/" $F\ncat $F\nwpa_cli -i wlan0 reconfigure\nhostname -I                \n')}}]),e}(),l=Object(k.a)(s.prototype,"open",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=Object(k.a)(s.prototype,"curSsid",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Office"}}),p=Object(k.a)(s.prototype,"curPassword",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"12345678"}}),d=Object(k.a)(s.prototype,"newSsid",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),h=Object(k.a)(s.prototype,"newPassword",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=Object(k.a)(s.prototype,"cluster",[x.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new $}}),Object(k.a)(s.prototype,"script",[x.computed],Object.getOwnPropertyDescriptor(s.prototype,"script"),s.prototype),s);window.S=F;var z=F,W=n(28),D=n(138),T=n(139),B=n(85),_=n(86),I=n(140),N=n(57),q=n.n(N),A=n(141),L=n(137),R=n(144),G=n(132),J=n(131),M=n(130),U=n(142),V=Object(W.a)((function(){return m.a.createElement(R.a,{id:"dialog",open:z.open,onClose:z.handleClose,"aria-labelledby":"form-dialog-title"},m.a.createElement(M.a,{id:"form-dialog-title"},"WiFi"),m.a.createElement(J.a,null,m.a.createElement(U.a,{autoFocus:!0,margin:"dense",id:"ssid",label:"SSID",type:"text",fullWidth:!0,value:z.newSsid,onChange:function(e){z.newSsid=e.target.value}}),m.a.createElement(U.a,{margin:"dense",id:"password",label:"PASSWORD",type:"password",fullWidth:!0,value:z.newPassword,onChange:function(e){z.newPassword=e.target.value}})),m.a.createElement(G.a,null,m.a.createElement(_.a,{onClick:z.handleClose,color:"primary"},"Cancel"),m.a.createElement(_.a,{onClick:z.handleConfirm,color:"primary"},"Confirm")))})),H=n(134),K=n(136),Q=n(135),X=n(133),Y=Object(W.a)((function(e){var t=e.pi;return m.a.createElement(X.a,{item:!0,sm:4,xs:12},m.a.createElement(H.a,{style:{margin:10,borderColor:t.connected?"green":"red"},variant:"outlined"},m.a.createElement(Q.a,null,m.a.createElement(B.a,{variant:"h5",component:"h2"},t.device.name),m.a.createElement(B.a,{style:{color:t.connected?"green":"red"},variant:"body2",component:"h2"},t.connected?"connected":"connecting"),m.a.createElement("pre",{style:{height:"200px",width:"100%",overflow:"scroll"}},t.log)),m.a.createElement(K.a,null,m.a.createElement(_.a,{size:"small",onClick:function(){return t.send(z.script)}},"Send"))))})),Z=Object(W.a)((function(){return m.a.createElement(X.a,{container:!0},Object(x.values)(z.cluster.dict).map((function(e,t){return m.a.createElement(Y,{key:t,pi:e})})))})),ee=Object(L.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),te=Object(W.a)((function(){var e=ee();return m.a.createElement(m.a.Fragment,null,m.a.createElement(D.a,{position:"static"},m.a.createElement(T.a,null,m.a.createElement(I.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu"},m.a.createElement(q.a,null)),m.a.createElement(B.a,{variant:"h6",className:e.title},"Cluster Pi WiFi Config"),m.a.createElement(A.a,{color:"primary","aria-label":"outlined primary button group"},m.a.createElement(_.a,{variant:"outlined",color:"inherit",onClick:z.handleSend},"Send All"),m.a.createElement(_.a,{variant:"outlined",color:"inherit",onClick:z.handleScan},"BLE Scan"),m.a.createElement(_.a,{variant:"outlined",color:"inherit",onClick:z.handleClickOpen},"WiFi Config")))),m.a.createElement("p",null,m.a.createElement("strong",null,"Note:")," the permissions API requires that you enable the Experimental Web Platform Features flag in Chrome: ",m.a.createElement("code",null,"chrome://flags/#enable-experimental-web-platform-features")),m.a.createElement(V,null),m.a.createElement(Z,null))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(81);w.a.render(m.a.createElement(m.a.StrictMode,null,m.a.createElement(te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[68,1,2]]]);
//# sourceMappingURL=main.585b84d6.chunk.js.map